permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent) +
scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Buffer Radius (m)\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
xlim(-.3,.3)+
theme_minimal() +
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent) +
scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Buffer Radius (m)\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
xlim(-.3,.3)+
theme_minimal()
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Buffer Radius (m)\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
xlim(-.3,.3)+
theme_minimal()
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
#scale_x_continuous(labels=scales::percent) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Buffer Radius (m)\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
xlim(-.3,.3)+
theme_minimal()
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
xlim(-.3,.3)+
theme_minimal()
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent_format()) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
xlim(-.3,.3)+
theme_minimal()
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
xlim(-.3,.3)+
theme_minimal()
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal()
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Density\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal()
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Density\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal() +
geom_label(aes(x = -0.07, y = 9.8, label = "Whites More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 1) +
geom_label(aes(x = 0.05, y = 9.8, label = "BIPOC More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0) +
expand_limits(y = c(0, 9.96)) # increase the y-axis limit to include the label elements
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Density\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal() +
geom_label(aes(x = -0.07, y = 9.8, label = "Whites More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 1) +
geom_label(aes(x = 0.05, y = 9.8, label = "BIPOC More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0)
# expand_limits(y = c(0, 9.96)) # increase the y-axis limit to include the label elements
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
# Visualize density plot of single buffer size, if needed
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Density\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal() +
geom_label(aes(x = -0.07, y = 9.8, label = "Whites More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 1) +
geom_label(aes(x = 0.05, y = 9.8, label = "BIPOC More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0)
# expand_limits(y = c(0, 9.96)) # increase the y-axis limit to include the label elements
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
permutation_test_plot2(test, buffer_sizes)
# Visualize density plot of single buffer size, if needed
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Density\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal() +
geom_label(aes(x = -0.1, y = 17.5, label = "Whites More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 1) +
geom_label(aes(x = 0.15, y = 17.5, label = "BIPOC More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0)
# expand_limits(y = c(0, 9.96)) # increase the y-axis limit to include the label elements
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
permutation_test_plot2(test, buffer_sizes)
# Visualize density plot of single buffer size, if needed
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Density\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal() +
geom_label(aes(x = -0.1, y = 17.5, label = "Whites More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0) +
geom_label(aes(x = 0.15, y = 17.5, label = "BIPOC More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0)
# expand_limits(y = c(0, 9.96)) # increase the y-axis limit to include the label elements
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
permutation_test_plot2(test, buffer_sizes)
# Visualize density plot of single buffer size, if needed
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Density\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal() +
geom_label(aes(x = -0.2, y = 17.5, label = "Whites More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0) +
geom_label(aes(x = 0.15, y = 17.5, label = "BIPOC More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0)
# expand_limits(y = c(0, 9.96)) # increase the y-axis limit to include the label elements
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
test$actual.value
# Visualize density plot of single buffer size, if needed
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
max_density <- max(data$statistic, na.rm = TRUE)
pval <- mean(data$statistic > actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Density\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal() +
geom_label(aes(x = -0.2, y = 17.5, label = "Whites More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0) +
geom_label(aes(x = 0.15, y = 17.5, label = "BIPOC More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0)
# expand_limits(y = c(0, 9.96)) # increase the y-axis limit to include the label elements
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
print(pval)
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
# Visualize density plot of single buffer size, if needed
permutation_test_plot2 <- function(data,buffer_size){
actual.value <- data$actual.value
data <- data$results
#max_density <- max(data$statistic, na.rm = TRUE)
#mean(abs(results$statistic) >= actual.value
pval <- mean(abs(data$statistic) >= actual.value)
pval_label <- paste0("p-value:\n", round(pval, 3))
act_label <- paste0("act. value:\n", round(actual.value, 3))
plot <- ggplot(data,
aes(x=statistic)) +
geom_density() +
geom_vline(xintercept=actual.value,color="red") +
#annotate("text", x=-.1, y=35, label=pval_label, color="red", size=3) + # add the label
#annotate("text", x=.12, y=35, label=act_label, color="red", size=3) + # add the label
#ylim(0, 50) +  # set y limits
scale_x_continuous(labels=scales::percent,
breaks = seq(-0.3, 0.3, 0.1),
limits = c(-0.3, 0.3)) +
#scale_y_discrete(labels = function(x) scales::comma(as.numeric(x))) +
labs(y = "Density\n",
x = "\n(In Buffer Minority %) - (Out Buffer Minority %)") +
# xlim(-.3,.3)+
theme_minimal() +
geom_label(aes(x = -0.2, y = 17.5, label = "Whites More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0) +
geom_label(aes(x = 0.15, y = 17.5, label = "BIPOC More Affected"),
size = 3, fill = "white", color = "black", label.padding = unit(0.3, "lines"),
label.size = 0.15, hjust = 0)
# expand_limits(y = c(0, 9.96)) # increase the y-axis limit to include the label elements
#labs(x=NULL, y=paste0(buffer_size,"m"))  # remove x label and add y label
print(pval)
return(plot)
}
test <- permutation_test(paths, buffer_sizes)
permutation_test_plot2(test, buffer_sizes)
